# 1. 데드락 (Deadlock)

## 1.1 데드락이란?

<img src="images\데드락.png" width="500" height="300"/>

두 개 이상의 작업이 **서로 상대방의 작업이 끝나기 만을 기다리고 있기 때문에** 결과적으로 아무것도 완료되지 못하는 상태

### 실생활 예시

```
하나의 사다리가 있고, 두 명의 사람이 각각 사다리의 위쪽과 아래쪽에 있다고 가정한다. 이때 아래에 있는 사람은 위로 올라 가려고 하고, 위에 있는 사람은 아래로 내려오려고 한다면, 두 사람은 서로 상대방이 사다리에서 비켜줄 때까지 하염없이 기다리고 있을 것
```

## 1.2 데드락 발생 조건 (Coffman의 4가지 조건)

1971년 E.G. 콮만 교수는 교착상태가 일어나려면 다음과 같은 네 가지 필요 조건을 충족시켜야 한다고 보였다.

1. **상호배제상호배제(Mutual Exclusion)**: 프로세스들이 필요로 하는 자원에 대해 배타적인 통제권을 요구한다.
2. **점유대기(Hold and Wait)**: 프로세스가 할당된 자원을 가진 상태서 다른 자원을 기다린다.
3. **비선점(No Preemption)**: 프로세스가 어떤 자원의 사용을 끝낼 때까지 그 자원을 뺏을 수 없다.
4. **순환대기(Circular Wait)**: 각 프로세스는 순환적으로 다음 프로세스가 요구하는 자원을 가지고 있다.

## 1.3 데드락 해결 방법

### 1. 예방 (Prevention)

교착 상태 발생 조건 중 하나를 제거하면서 해결한다.

- **상호배제 부정**: 여러 프로세스가 공유 자원 사용
- **점유대기 부정**: 프로세스 실행전 모든 자원을 할당
- **비선점 부정**: 자원 점유 중인 프로세스가 다른 자원을 요구할 때 가진 자원 반납
- **순환대기 부정:** 자원에 고유번호 할당 후 순서대로 자원 요구

### **단점**: 자원 이용률(Resource Utilization) 이 낮아진다는 치명적인 단점

### 2. 회피 (Avoidance)

프로세스가 자원을 요구할 때, 시스템은 자원을 할당한 후에도 안정 상태로 남아있게 되는지 사전에 검사하여 교착 상태 회피

#### 은행원 알고리즘 (Banker's Algorithm)

시스템의 프로세스들이 요청하는 모든 자원을, 데드락을 발생시키지 않으면서도 차례로 모두에게 할당해 줄 수 있다면 안정 상태(safe state)에 있다고 말한다.

- **Safe State**: 모든 프로세스가 정상 종료 가능한 상태
- **Safe Sequence**: 데드락 없이 프로세스들을 순서대로 실행 가능한 순서

### 3. 탐지 & 회복 (Detection & Recovery)

데드락이 발생했을 때가 되어서야 그때가서 조치를 취하는 방법

#### 회복 방법

- **프로세스 종료**: 교착 상태 일으킨 프로세스를 종료하거나, 할당된 자원을 해제시켜 회복시키는 방법
- **자원 선점**: 교착 상태의 프로세스가 점유하고 있는 자원을 선점해 다른 프로세스에게 할당

### 4. 무시 (Ignore)

예방 혹은 회피기법을 프로그래밍해서 넣으면 성능에 큰 영향을 미칠 수 있게 된다. 그렇기 때문에 데드락의 발생 확률이 비교적 낮은 경우 별다른 조치를 취하지 않는다.

## 핵심 요약

### 데드락

- **발생 조건**: 상호배제 + 점유대기 + 비선점 + 순환대기
- **해결 방법**: 예방(자원 비효율) vs 회피(복잡) vs 탐지&회복(실용적)
- **실무 접근**: 발생 확률이 낮으면 무시하는 것도 전략

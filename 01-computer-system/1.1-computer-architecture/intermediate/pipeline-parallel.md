# 1. 파이프라인과 병렬 처리

## 1.1 파이프라인 (Pipeline)

<img src="images\파이프라인.png" width="700" height="300"/>

**파이프라인** 은 명령어 처리를 여러 단계로 나누어 동시에 처리하는 기법이다. 공장의 컨베이어 벨트처럼 각 단계가 동시에 다른 작업을 처리하여 전체 처리량을 향상시킨다.

### 5단계 RISC 파이프라인

```
IF (Instruction Fetch)   : 메모리에서 명령어 가져오기
ID (Instruction Decode) : 명령어 해석 및 레지스터 읽기
EX (Execute)            : 실제 연산 수행
MEM (Memory Access)     : 메모리 읽기/쓰기
WB (Write Back)         : 결과를 레지스터에 저장
```

#### 이상적인 경우 : 5단계 파이프라인으로 5배 성능 향상 가능하지만, 실제로는 해저드(Hazard)로 인해 그보다 낮다.

#### 파이프라인 해저드와 해결책

`1.  구조적 해저드 (Structural Hazard)`

```
원인: 하드웨어 자원이 부족하여 두 명령어가 같은 자원을 동시에 사용하려 할 때
예시: 명령어 페치와 데이터 로드가 같은 메모리를 동시 접근
해결: 하드웨어 설계 시 자원 분리 (하버드 구조 등)
```

`2. 데이터 해저드 (Data Hazard)`

```
원인: 앞선 명령어의 결과를 뒤 명령어가 사용해야 하는 의존성
예시: ADD R1, R2, R3 다음에 SUB R4, R1, R5가 오면 R1 값이 필요
해결: 포워딩(결과를 바로 전달), 파이프라인 스톨(대기)
```

`3. 제어 해저드 (Control Hazard)`

```
원인: 분기 명령어로 인한 실행 흐름 변경
해결: 분기 예측, 지연 분기, 추측 실행
```

## 1.2 병렬 처리 (Parallel Processing)

<img src="images\병렬처리 기법.png" width="600" height="350"/>

**병렬 처리**는 여러 프로세서나 코어를 사용하여 동시에 계산을 수행하는 방법입니다.

### Flynn의 분류법

- **SISD** : 단일 명령어, 단일 데이터 (전통적인 순차 처리)
- **SIMD** : 단일 명령어, 다중 데이터 (벡터 처리, GPU의 기본 방식)
- **MIMD** : 다중 명령어, 다중 데이터 (멀티 코어, 멀티 프로세서)

### 병렬 처리 모델

#### 데이터 병렬 처리 (Data Parallelism)

- **개념**: 큰 데이터를 여러 부분으로 나누어 같은 연산을 동시 수행
- **예시**: 1000개 배열을 4개 코어가 250개씩 나누어 처리
- **장점**: 구현이 비교적 간단, 확장성 좋음
- **적용**: 행렬 연산, 이미지 처리, 과학 계산

#### 태스크 병렬 처리 (Task Parallelism)

- **개념**: 서로 다른 작업을 동시에 수행
- **예시**: 한 스레드는 입출력, 다른 스레드는 연산 처리
- **장점**: 다양한 작업의 동시 처리
- **단점**: 부하 분산과 동기화가 복잡

### 병렬 시스템 구조

#### SMP (Symmetric Multi-Processing)

```
구조: 여러 CPU가 하나의 메모리를 공유
특징: 모든 CPU가 동등한 권한, 프로그래밍 단순
한계: 메모리 경합으로 8~16 CPU 정도가 한계
```

#### MPP (Massively Parallel Processing)

```
구조: 수천 개의 독립된 프로세서가 네트워크로 연결
특징: 각 노드가 독립된 메모리, 메시지 패싱으로 통신
장점: 뛰어난 확장성
단점: 복잡한 프로그래밍
```

#### NUMA (Non-Uniform Memory Access)

```
구조: 각 프로세서에 로컬 메모리 + 공유 메모리 영역
특징: 메모리 접근 시간이 위치에 따라 다름
장점: SMP의 확장성 한계와 MPP의 복잡성 문제 해결
```

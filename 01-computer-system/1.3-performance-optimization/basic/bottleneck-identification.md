# 1. 기본적인 병목 지점 식별

## 1.1 병목 현상이란?

### 정의

"병목 현상"은 한 구성 요소로 인해서 더 강력한 성능의 구성 요소가 최고의 성능을 발휘하지 못할때 발생한다. 병(bottle)의 목(neck)에 비유해서 어떠한 특정 요소의 한계 때문에 전체가 제한받는 상황

### 균형 잡힌 시스템의 중요성

"균형 잡힌" PC란 게이밍과 같이 시스템이 처리할 워크로드에 적합한 하드웨어를 구비하고 "병목 현상"을 방지하도록 설계된 시스템을 의미한다.

## 1.2 주요 병목 지점들

### 1. CPU 병목

<img src="images\PC병목현상.png" width="500" height="300"/>

#### 식별 방법

- Windows 작업 관리자에서 CPU 사용률 확인
- Linux: sysstat 번들 사용
- 유휴 상태에서 모든 프로세스의 CPU 사용량 합이 10% 미만이어야 정상

#### 원인

- 백그라운드 프로세스 과다 실행
- 멀웨어 감염 (크립토재킹 등)
- 열 기반 성능 저하
- 부적절한 애플리케이션 설계

#### 해결 방법

- 불필요한 백그라운드 프로세스 제거
- 멀웨어 검사 및 제거
- 적절한 쿨링 시스템 구축
- 워크로드 분산

### 2. 메모리 병목

#### 병목 발생 과정

```
CPU ↔ 시스템 버스 ↔ 메인 메모리
```

#### 주요 문제

- 메모리 부족: 스와핑 발생으로 인한 성능 저하
- 메모리 속도: CPU와 메모리 간 속도 차이
- 캐시 미스: 필요한 데이터가 캐시에 없을 때

#### 해결 방법

- 충분한 메모리 용량 확보
- 듀얼채널 메모리 구성
- 고속 메모리 사용
- 캐시 친화적 프로그래밍

### 3 저장장치 병목

#### HDD vs SSD 성능 차이

| 구분      | HDD     | SATA SSD | NVMe SSD  |
| --------- | ------- | -------- | --------- |
| 순차 읽기 | 150MB/s | 500MB/s  | 3,500MB/s |
| 랜덤 접근 | 5-10ms  | 0.1ms    | 0.05ms    |
| IOPS      | 100-200 | 50,000+  | 100,000+  |

#### 병목 해결 방법:

1. HDD → SSD 업그레이드
2. SATA SSD → NVMe SSD 업그레이드
3. 충분한 가상 메모리 설정 (RAM의 1.5~3배)
4. 임시 파일을 고속 드라이브에 저장

### 4. 네트워크 병목

#### 특징

- 컴퓨터 내부 인터페이스에 비해 월등히 느린 네트워크는 거의 대부분 항상 병목 상태
- 네트워크를 통한 데이터 왕복 시간도 Latency에 포함

#### 측정 방법

- 핑(Ping) 시간 측정
- 대역폭 테스트
- 패킷 손실률 확인

## 1.3 병목 지점 식별 도구

### Windows 환경

1. 작업 관리자: 기본적인 시스템 리소스 모니터링
2. 성능 모니터(perfmon): 상세한 성능 카운터 추적
3. Process Monitor: 파일, 레지스트리, 네트워크 활동 모니터링

### Linux 환경

1. top/htop: CPU 및 메모리 사용량 실시간 모니터링
2. iostat: 디스크 I/O 통계
3. sar: 시스템 활동 보고서
4. netstat: 네트워크 연결 상태

### 전문 도구

1. APM 솔루션: 애플리케이션 레벨 성능 분석
2. Profiling 도구: 코드 레벨 성능 분석
3. 부하 테스트 도구: 성능 한계점 식별

## 1.4 최적화 전략

### 우선순위 기반 접근

1. 병목 지점 식별: 가장 느린 구간 찾기
2. 영향도 평가: 전체 성능에 미치는 영향 분석
3. 비용 대비 효과: 개선 비용 vs 성능 향상 효과
4. 단계적 개선: 한 번에 하나씩 개선하여 효과 측정

### 성능 최적화 원칙

```
병목이 아닌 구간을 개선하는 것은,
전체의 Throughput을 개선하는 데에 전혀 도움이 되지 않습니다.
도리어 대기가 늘어나 Throughput이 감소할 수도 있습니다.
```

### 핵심 전략

- 측정 우선: 추측하지 말고 측정해야 함
- 병목 집중: 가장 느린 부분을 우선 개선해야 함
- 균형 유지: 전체적인 시스템 균형을 고려해야 함
- 지속적 모니터링: 개선 후에도 지속적인 성능을 추적해야 함

# 2. 성능 테스트 방법론

## 2.1 성능 테스트 유형

### 성능 테스트 (Performance Test)

- 목적: 시스템의 요소가 특정 상황에서 어느 정도의 성능을 보이는지를 측정
- 특징: 기존 시스템에 대한 benchmarking, 애플리케이션의 결함을 찾는 목적이 아님
- 중요사항: 성능에 대한 정확하고 면밀한 모니터링 진행 필요

### 부하 테스트 (Load Test)

- 목적: 임계치의 한계에 도달할 때까지 시스템에 부하를 꾸준히 증가시키며 진행
- 특징: 발생시키는 부하는 실제 시스템에 적용될 예상 트래픽이어야 함
- 별명: Volume test 또는 Endurance test

### 스트레스 테스트 (Stress Test)

- 목적: 시스템의 한계점을 찾아서 미래에 발생할 부하에 대비
- 특징: Web Server, Database, Infra등 모든 요소의 한계를 찾음

## 2.2 핵심 성능 지표

### 응답 시간 기준

- 3초 법칙: 사용자는 응답 시간이 3초를 넘으면 느리다고 느낌
- 6초 한계: 6초를 한계로 봄
- 1초 이하: 이상적인 응답 시간

### 가용성 지표

- 업타임: 애플리케이션이 실행되고 사용 가능한 총 시간
- 오류율: 애플리케이션에서 발생하는 오류의 빈도
- Apdex 점수: 일반 성능 지표와 비교한, 앱의 상대적 성능

## 핵심 요약

### 병목 지점 식별

- CPU: 사용률 모니터링, 백그라운드 프로세스 관리
- 메모리: 충분한 용량 확보, 캐시 최적화
- 저장장치: HDD→SSD 업그레이드, NVMe 활용
- 네트워크: 대역폭과 지연시간 최적화

### 최적화 전략

- 측정 기반: 추측하지 말고 측정하라
- 병목 우선: 가장 느린 부분부터 개선
- 단계적 접근: 한 번에 하나씩 개선하여 효과 검증
- 지속적 모니터링: 개선 후에도 성능 추적 유지

### 성능 테스트

- 목적별 구분: 성능/부하/스트레스 테스트
- 실제 환경: 운영 환경과 유사한 조건에서 테스트
- 점진적 접근: 예상 부하부터 시작하여 점차 증가
